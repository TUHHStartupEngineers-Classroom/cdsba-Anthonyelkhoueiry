{
  "hash": "fc61fa52b1ebd973b4f604465f1fd62e",
  "result": {
    "markdown": "---\ntitle: \"Chap1: Probability\"\nauthor: \"Anthony El Khoueiry\"\ndate: \"\"\nformat: \n    html:\n      code-line-numbers: true\n      df-print: paged\n\n---\n\n----\n\n#### **Part 1.1**\n\n::: {.cell hash='01_probability_cache/html/unnamed-chunk-1_9f713636cb27ed5f2d1334ba0d7dfa4f'}\n\n```{.r .cell-code}\n# Given probabilities\nP_S <- 0.3\nP_T_S <- 0.2\nP_T_S_Bar <- 0.6\nP_S_Bar <- 1 - P_S\nP_T_Bar_S <- 1 - P_T_S\nP_T_Bar_S_Bar <- 1 - P_T_S_Bar\n\n# The conditional probabilities are:\nP_T_inter_S <- P_S * P_T_S\nP_T_inter_S_Bar <- P_S_Bar * P_T_S_Bar\nP_T_Bar_inter_S <- P_S * P_T_Bar_S\nP_T_Bar_inter_S_Bar <- P_S_Bar * P_T_Bar_S_Bar\n\n# The results to be printed:\nprint(P_T_inter_S)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> [1] 0.06\n```\n:::\n\n```{.r .cell-code}\nprint(P_T_inter_S_Bar)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> [1] 0.42\n```\n:::\n\n```{.r .cell-code}\nprint(P_T_Bar_inter_S)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> [1] 0.24\n```\n:::\n\n```{.r .cell-code}\nprint(P_T_Bar_inter_S_Bar)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> [1] 0.28\n```\n:::\n:::\n\n#### **Part 1.2**\n\n::: {.cell hash='01_probability_cache/html/unnamed-chunk-2_da1480158619ff31e41eb7ef0febd327'}\n\n```{.r .cell-code}\n# Libraries\nlibrary(tidyverse)\nlibrary(ggVennDiagram)\n\n# Number of observations\nn <- 1000\n\n# Tibble with user information:\napp_usage <- tibble(\n  user_id = 1:n,\n  smartphone = rbinom(n, 1, 0.4),\n  tablet = ifelse(smartphone == 1, rbinom(n, 1, 0.2), rbinom(n, 1, 0.5)),\n  computer = ifelse(tablet == 1, rbinom(n, 1, 0.1), rbinom(n, 1, 0.3))\n)\n\n#At least one device is used per user:\napp_usage <- app_usage %>%\n  rowwise() %>% \n  mutate(smartphone = ifelse(sum(smartphone, tablet, computer) == 0, 1, smartphone))\n\n# the first ten rows of the data:\nhead(app_usage, 10)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"user_id\"],\"name\":[1],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"smartphone\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"tablet\"],\"name\":[3],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"computer\"],\"name\":[4],\"type\":[\"int\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"1\",\"2\":\"0\",\"3\":\"1\",\"4\":\"0\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"0\",\"4\":\"0\"},{\"1\":\"3\",\"2\":\"0\",\"3\":\"0\",\"4\":\"1\"},{\"1\":\"4\",\"2\":\"1\",\"3\":\"0\",\"4\":\"0\"},{\"1\":\"5\",\"2\":\"1\",\"3\":\"0\",\"4\":\"0\"},{\"1\":\"6\",\"2\":\"1\",\"3\":\"0\",\"4\":\"0\"},{\"1\":\"7\",\"2\":\"0\",\"3\":\"1\",\"4\":\"0\"},{\"1\":\"8\",\"2\":\"1\",\"3\":\"0\",\"4\":\"0\"},{\"1\":\"9\",\"2\":\"1\",\"3\":\"0\",\"4\":\"0\"},{\"1\":\"10\",\"2\":\"0\",\"3\":\"1\",\"4\":\"1\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n\n```{.r .cell-code}\n# column sums:\ncolSums(app_usage)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#>    user_id smartphone     tablet   computer \n#>     500500        613        387        214\n```\n:::\n\n```{.r .cell-code}\n# sets of phone, tablet, and computer users:\nset_phon <- which(app_usage$smartphone == 1)\nset_tabl <- which(app_usage$tablet == 1)\nset_comp <- which(app_usage$computer == 1)\n\n# List of all sets:\nsets_all <- list(set_phon, set_tabl, set_comp)\n\n# Plot Venn diagram:\nggVennDiagram(sets_all, category.names = c(\"Smartphone\", \"Tablet\", \"Computer\"),\n              label_percent_digit = 2) +\n  theme(legend.position = \"none\", \n        panel.background = element_rect(\"green\"),\n        strip.background = element_rect(\"red\")) +\n  scale_x_continuous(expand = expansion(mult = .24))\n```\n\n::: {.cell-output-display}\n![](01_probability_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# the intersection of sets (users using all three devices):\nset_all_three <- Reduce(intersect, sets_all)\npercentage_all_three <- length(set_all_three) / n * 100\ncat(\"Percentage of customers using all three devices:\", round(percentage_all_three, 2), \"%\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> Percentage of customers using all three devices: 0.7 %\n```\n:::\n\n```{.r .cell-code}\n# the union of sets (users using at least two devices):\nset_at_least_two <- union(intersect(set_phon, set_tabl), union(intersect(set_phon, set_comp), intersect(set_comp, set_tabl)))\npercentage_at_least_two <- length(set_at_least_two) / n * 100\ncat(\"Percentage of customers using at least two devices:\", round(percentage_at_least_two, 2), \"%\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> Percentage of customers using at least two devices: 20.7 %\n```\n:::\n\n```{.r .cell-code}\n# the sets of users using each device exclusively\nset_only_phon <- set_phon[!(set_phon %in% set_tabl) & !(set_phon %in% set_comp)]\nset_only_tabl <- set_tabl[!(set_tabl %in% set_phon) & !(set_tabl %in% set_comp)]\nset_only_comp <- set_comp[!(set_comp %in% set_phon) & !(set_comp %in% set_tabl)]\npercentage_only_one <- (length(set_only_phon) + length(set_only_tabl) + length(set_only_comp)) / n * 100\ncat(\"Percentage of customers using only one device:\", round(percentage_only_one, 2), \"%\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> Percentage of customers using only one device: 79.3 %\n```\n:::\n:::\n\n#### **Part 1.3**\n\n::: {.cell hash='01_probability_cache/html/unnamed-chunk-3_7c0f3d6c9f861448540868192989131c'}\n\n```{.r .cell-code}\n# Given probabilities\nprob_A <- 0.04\nprob_B_given_A <- 0.97\nprob_not_B_given_A <- 0.01\nprob_not_A <- 1 - prob_A\nprob_not_B_given_not_A <- 1 - prob_B_given_A\nprob_not_B_given_not_A_not <- 1 - prob_not_B_given_A\n\n# overall probability of B\nprob_B <- (prob_B_given_A * prob_A) + (prob_not_B_given_A * prob_not_A)\n\n# conditional probability of not A given B\nprob_not_A_given_B <- (prob_not_B_given_A * prob_not_A) / prob_B\n\n# conditional probability of A given B\nprob_A_given_B <- (prob_B_given_A * prob_A) / prob_B\n\n# results\nprint(prob_not_A_given_B)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> [1] 0.1983471\n```\n:::\n\n```{.r .cell-code}\nprint(prob_A_given_B)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> [1] 0.8016529\n```\n:::\n:::",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../../site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\r\n<script src=\"../../site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}