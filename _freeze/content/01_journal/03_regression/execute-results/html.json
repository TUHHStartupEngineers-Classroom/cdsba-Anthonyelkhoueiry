{
  "hash": "818b922b8d8020388fd5e3d645873a9b",
  "result": {
    "markdown": "---\ntitle: \"Chap3: Regression\"\nauthor: \"Anthony El Khoueiry\"\ndate: \"\"\nformat: \n    html:\n      code-line-numbers: true\n      df-print: paged\n\n---\n\n----\n\n\n\n::: {.cell hash='03_regression_cache/html/unnamed-chunk-1_44435fa17c094cb93291ad2fd886e6ee'}\n\n```{.r .cell-code}\n# Libraries\nlibrary(dplyr)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n#> \n#> Attaching package: 'dplyr'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n#> The following objects are masked from 'package:stats':\n#> \n#>     filter, lag\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n#> The following objects are masked from 'package:base':\n#> \n#>     intersect, setdiff, setequal, union\n```\n:::\n\n```{.r .cell-code}\nlibrary(modelr)\n\n# The dataset containing information on car prices\ncar_dataset <- readRDS(\"C:/Users/user/OneDrive/Desktop/UNI/TUHH/SEM 3/CAUSAL DATA SC/RDS/car_prices.rds\")\n\n# The dataset and its dimensions\ndata_dimensions <- dim(car_dataset)\nnum_rows <- data_dimensions[1]\nnum_columns <- data_dimensions[2]\ncat(\"Total rows in the dataset:\", num_rows, \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> Total rows in the dataset: 181\n```\n:::\n\n```{.r .cell-code}\ncat(\"Total columns in the dataset:\", num_columns, \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> Total columns in the dataset: 22\n```\n:::\n\n```{.r .cell-code}\n# Column names for each dataframe in the dataset\ncolumn_names_list <- lapply(car_dataset, colnames)\n\n# Explore the data types of selected columns\nfirst_car_width <- head(car_dataset$carwidth, 1)\ncat(\"The data type of car width is\", typeof(first_car_width), \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> The data type of car width is double\n```\n:::\n\n```{.r .cell-code}\nfirst_car_body <- head(car_dataset$carbody, 1)\ncat(\"The data type of car body is\", typeof(first_car_body), \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> The data type of car body is character\n```\n:::\n\n```{.r .cell-code}\nprint(\"Two main types are char and double.\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> [1] \"Two main types are char and double.\"\n```\n:::\n\n```{.r .cell-code}\nprint(\"Numeric types like double are suitable for quantitative information, while strings and char are useful for textual and categorical information. It is crucial to accurately represent real-world attributes in the dataset.\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> [1] \"Numeric types like double are suitable for quantitative information, while strings and char are useful for textual and categorical information. It is crucial to accurately represent real-world attributes in the dataset.\"\n```\n:::\n\n```{.r .cell-code}\n# Linear Regression\nglimpse(car_dataset)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> Rows: 181\n#> Columns: 22\n#> $ aspiration       <chr> \"std\", \"std\", \"std\", \"std\", \"std\", \"std\", \"std\", \"std…\n#> $ doornumber       <chr> \"two\", \"two\", \"two\", \"four\", \"four\", \"two\", \"four\", \"…\n#> $ carbody          <chr> \"convertible\", \"convertible\", \"hatchback\", \"sedan\", \"…\n#> $ drivewheel       <chr> \"rwd\", \"rwd\", \"rwd\", \"fwd\", \"4wd\", \"fwd\", \"fwd\", \"fwd…\n#> $ enginelocation   <chr> \"front\", \"front\", \"front\", \"front\", \"front\", \"front\",…\n#> $ wheelbase        <dbl> 88.6, 88.6, 94.5, 99.8, 99.4, 99.8, 105.8, 105.8, 105…\n#> $ carlength        <dbl> 168.8, 168.8, 171.2, 176.6, 176.6, 177.3, 192.7, 192.…\n#> $ carwidth         <dbl> 64.1, 64.1, 65.5, 66.2, 66.4, 66.3, 71.4, 71.4, 71.4,…\n#> $ carheight        <dbl> 48.8, 48.8, 52.4, 54.3, 54.3, 53.1, 55.7, 55.7, 55.9,…\n#> $ curbweight       <dbl> 2548, 2548, 2823, 2337, 2824, 2507, 2844, 2954, 3086,…\n#> $ enginetype       <chr> \"dohc\", \"dohc\", \"ohcv\", \"ohc\", \"ohc\", \"ohc\", \"ohc\", \"…\n#> $ cylindernumber   <chr> \"four\", \"four\", \"six\", \"four\", \"five\", \"five\", \"five\"…\n#> $ enginesize       <dbl> 130, 130, 152, 109, 136, 136, 136, 136, 131, 131, 108…\n#> $ fuelsystem       <chr> \"mpfi\", \"mpfi\", \"mpfi\", \"mpfi\", \"mpfi\", \"mpfi\", \"mpfi…\n#> $ boreratio        <dbl> 3.47, 3.47, 2.68, 3.19, 3.19, 3.19, 3.19, 3.19, 3.13,…\n#> $ stroke           <dbl> 2.68, 2.68, 3.47, 3.40, 3.40, 3.40, 3.40, 3.40, 3.40,…\n#> $ compressionratio <dbl> 9.00, 9.00, 9.00, 10.00, 8.00, 8.50, 8.50, 8.50, 8.30…\n#> $ horsepower       <dbl> 111, 111, 154, 102, 115, 110, 110, 110, 140, 160, 101…\n#> $ peakrpm          <dbl> 5000, 5000, 5000, 5500, 5500, 5500, 5500, 5500, 5500,…\n#> $ citympg          <dbl> 21, 21, 19, 24, 18, 19, 19, 19, 17, 16, 23, 23, 21, 2…\n#> $ highwaympg       <dbl> 27, 27, 26, 30, 22, 25, 25, 25, 20, 22, 29, 29, 28, 2…\n#> $ price            <dbl> 13495.00, 16500.00, 16500.00, 13950.00, 17450.00, 152…\n```\n:::\n\n```{.r .cell-code}\n# Convert all columns to numeric\ncar_dataset[] <- lapply(car_dataset, as.numeric)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n#> Warning in lapply(car_dataset, as.numeric): NAs introduced by coercion\n\n#> Warning in lapply(car_dataset, as.numeric): NAs introduced by coercion\n\n#> Warning in lapply(car_dataset, as.numeric): NAs introduced by coercion\n\n#> Warning in lapply(car_dataset, as.numeric): NAs introduced by coercion\n\n#> Warning in lapply(car_dataset, as.numeric): NAs introduced by coercion\n\n#> Warning in lapply(car_dataset, as.numeric): NAs introduced by coercion\n\n#> Warning in lapply(car_dataset, as.numeric): NAs introduced by coercion\n\n#> Warning in lapply(car_dataset, as.numeric): NAs introduced by coercion\n```\n:::\n\n```{.r .cell-code}\n# The correlation matrix\ncorrelation_matrix <- car_dataset %>% cor() %>% round(2) %>% Matrix::tril()\n\n# Data type and range of the chosen predictor (enginesize)\nfirst_enginesize <- head(car_dataset$enginesize, 1)\nmin_enginesize <- min(car_dataset$enginesize)\nmax_enginesize <- max(car_dataset$enginesize)\ncat(\"The selected predictor is enginesize with a data type of \", typeof(first_enginesize), \" and it ranges between \", min_enginesize, \" and \", max_enginesize, \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> The selected predictor is enginesize with a data type of  double  and it ranges between  61  and  326\n```\n:::\n\n```{.r .cell-code}\n# The impact of enginesize on price\ncat(\"Enginesize has a significant effect on price, showing a positive correlation of 89%. As enginesize increases, the price tends to increase proportionally.\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> Enginesize has a significant effect on price, showing a positive correlation of 89%. As enginesize increases, the price tends to increase proportionally.\n```\n:::\n\n```{.r .cell-code}\n# New variable 'seat_heating_TRUE' with random TRUE/FALSE values\ndataset_with_seat_heating <- car_dataset %>%\n  mutate(seat_heating_TRUE = sample(c(TRUE, FALSE), size = nrow(car_dataset), replace = TRUE))\n\n# The distribution of seat_heating_TRUE\ntable(dataset_with_seat_heating$seat_heating_TRUE)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> \n#> FALSE  TRUE \n#>    90    91\n```\n:::\n\n```{.r .cell-code}\n# The regression with seat heating as a predictor\nlinear_regression_model <- lm(price ~ seat_heating_TRUE, data = dataset_with_seat_heating)\n\n# The summary of the linear regression model\nsummary(linear_regression_model)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> \n#> Call:\n#> lm(formula = price ~ seat_heating_TRUE, data = dataset_with_seat_heating)\n#> \n#> Residuals:\n#>    Min     1Q Median     3Q    Max \n#>  -8940  -5260  -3004   2500  31342 \n#> \n#> Coefficients:\n#>                       Estimate Std. Error t value Pr(>|t|)    \n#> (Intercept)            14058.3      845.5  16.627   <2e-16 ***\n#> seat_heating_TRUETRUE  -2106.2     1192.4  -1.766    0.079 .  \n#> ---\n#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#> \n#> Residual standard error: 8021 on 179 degrees of freedom\n#> Multiple R-squared:  0.01713,\tAdjusted R-squared:  0.01164 \n#> F-statistic:  3.12 on 1 and 179 DF,  p-value: 0.07904\n```\n:::\n\n```{.r .cell-code}\ncat(\"Assigning all values as true for seat heating can lead to issues in regression analysis, including collinearity problems and difficulties in estimating coefficients.\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> Assigning all values as true for seat heating can lead to issues in regression analysis, including collinearity problems and difficulties in estimating coefficients.\n```\n:::\n:::",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../../site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\r\n<script src=\"../../site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}